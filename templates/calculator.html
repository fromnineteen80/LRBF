{% extends "base.html" %}
{% block title %}Calculator - Railyard Markets{% endblock %}
{% block page_title %}Performance Calculator{% endblock %}
{% block content %}
<div class="card">
    <div class="card-header"><h3 class="card-title">Calculate Projections</h3></div>
    <div class="card-content">
        <form id="calcForm" class="grid grid-cols-2 gap-4">
            <div><label class="label-medium">Starting Capital</label><input type="number" id="startCap" value="30000" class="input-field"></div>
            <div><label class="label-medium">Daily ROI %</label><input type="number" step="0.1" id="dailyRoi" value="3.5" class="input-field"></div>
            <div><label class="label-medium">Trading Days</label><input type="number" id="tradeDays" value="252" class="input-field"></div>
            <div><label class="label-medium">Deployment Ratio</label><input type="number" step="0.01" id="deployRatio" value="0.80" class="input-field"></div>
        </form>
        <button class="button button-filled mt-4" onclick="calculate()">Calculate</button>
        <div id="results" style="display:none; margin-top: var(--md-sys-spacing-4);">
            <h4 class="title-medium mb-4">Results</h4>
            <p class="body-large">Final Balance: <strong id="finalBalance">-</strong></p>
            <p class="body-large">Total Gain: <strong id="totalGain">-</strong></p>
            <p class="body-large">Total ROI: <strong id="totalRoi">-</strong></p>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
async function calculate() {
    const data = {
        starting_capital: parseFloat(document.getElementById('startCap').value),
        daily_roi: parseFloat(document.getElementById('dailyRoi').value),
        trading_days: parseInt(document.getElementById('tradeDays').value),
        deployment_ratio: parseFloat(document.getElementById('deployRatio').value)
    };
    try {
        const result = await apiCall('/api/calculator/project', {method: 'POST', body: JSON.stringify(data)});
        document.getElementById('finalBalance').textContent = formatCurrency(result.final_balance);
        document.getElementById('totalGain').textContent = formatCurrency(result.total_gain);
        document.getElementById('totalRoi').textContent = result.total_roi.toFixed(2) + '%';
        document.getElementById('results').style.display = 'block';
        showSnackbar('Calculation complete');
    } catch (error) {
        showSnackbar('Calculation failed');
    }
}
</script>
{% endblock %}
