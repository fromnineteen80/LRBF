{% extends "base.html" %}

{% block title %}EOD Report - Railyard Markets{% endblock %}
{% block page_title %}End of Day Report{% endblock %}

{% block content %}
<md-elevated-card style="margin-bottom: 16px;">
    <div style="padding: 16px; border-bottom: 1px solid var(--md-sys-color-outline-variant);">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <md-icon style="color: var(--md-sys-color-primary);">nightlight</md-icon>
                <h3 class="card-title" style="margin: 0;">Daily Performance</h3>
            </div>
            <md-filled-button onclick="generateEOD()">
                <md-icon slot="icon">summarize</md-icon>
                Generate Report
            </md-filled-button>
        </div>
    </div>
    <div style="padding: 24px;">
        <div id="eodContent">
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                <div style="padding: 16px; background: var(--md-sys-color-surface-container); border-radius: 12px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <md-icon style="color: var(--md-sys-color-tertiary);">account_balance</md-icon>
                        <p class="label-medium" style="color: var(--md-sys-color-on-surface-variant); margin: 0;">Total P&L</p>
                    </div>
                    <h3 class="headline-small" id="eodPL" style="margin: 0; color: var(--md-sys-color-tertiary);">-</h3>
                </div>
                <div style="padding: 16px; background: var(--md-sys-color-surface-container); border-radius: 12px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <md-icon style="color: var(--md-sys-color-secondary);">percent</md-icon>
                        <p class="label-medium" style="color: var(--md-sys-color-on-surface-variant); margin: 0;">Win Rate</p>
                    </div>
                    <h3 class="headline-small" id="eodWinRate" style="margin: 0; color: var(--md-sys-color-secondary);">-</h3>
                </div>
                <div style="padding: 16px; background: var(--md-sys-color-surface-container); border-radius: 12px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <md-icon style="color: var(--md-sys-color-primary);">analytics</md-icon>
                        <p class="label-medium" style="color: var(--md-sys-color-on-surface-variant); margin: 0;">Sharpe Ratio</p>
                    </div>
                    <h3 class="headline-small" id="eodSharpe" style="margin: 0; color: var(--md-sys-color-primary);">-</h3>
                </div>
            </div>
        </div>
    </div>
</md-elevated-card>
{% endblock %}

{% block scripts %}
<script>
async function generateEOD() {
    try {
        const data = await apiCall('/api/eod/generate', {method: 'POST'});
        document.getElementById('eodPL').textContent = formatCurrency(data.realized_pl);
        document.getElementById('eodWinRate').textContent = data.win_rate.toFixed(1) + '%';
        document.getElementById('eodSharpe').textContent = data.sharpe_ratio.toFixed(2);
        showSnackbar('EOD report generated');
    } catch (error) {
        showSnackbar('Failed to generate EOD report');
    }
}
</script>
{% endblock %}
